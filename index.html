<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wheel of Names - Final Professional Edition</title>
    <style>
        :root {
            --bg-dark: #1a1a1b;
            --panel-dark: #121212;
            --card-bg: #1e1e1e;
            --btn-blue: #3b82f6;
            --border-color: #333;
            --stat-green: #4caf50;
            --browser-gray: #2b2d30;
            --link-blue: #58a6ff;
        }

        body { 
            font-family: 'Segoe UI', Tahoma, sans-serif; 
            margin: 0; 
            min-height: 100vh;
            color: white; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            overflow-x: hidden;
            background: radial-gradient(circle at center, #2c3e50 0%, #000000 100%);
            background-attachment: fixed;
        }

        .site-header {
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 20px;
            background: rgba(0,0,0,0.3);
            box-sizing: border-box;
        }
        .site-header .logo {
            font-size: 20px;
            font-weight: 500;
            padding: 2px 5px; 
        }
        .site-header .menu-icon {
            font-size: 24px;
            cursor: pointer;
        }

        .fake-browser-bar { background: var(--browser-gray); padding: 8px 15px; display: flex; align-items: center; gap: 15px; border-bottom: 1px solid #3c3f41; width: 100%; box-sizing: border-box; }
        .address-input-wrapper { flex-grow: 1; background: #1e1e1e; border-radius: 20px; padding: 6px 15px; display: flex; align-items: center; color: #888; font-size: 13px; border: 1px solid #3c3f41; }

        .main-stage { position: relative; margin: 40px 0; display: flex; justify-content: center; align-items: center; }
        .wheel-instructions { 
            position: absolute; 
            pointer-events: none; 
            z-index: 10; 
            width: 100%; 
            height: 100%;
            transition: opacity 0.3s;
        }
        .curved-svg { width: 100%; height: 100%; }
        .curved-text { fill: white; font-weight: 900; text-shadow: 2px 2px 6px rgba(0,0,0,0.8); }

        .wheel-box { position: relative; width: 380px; height: 380px; cursor: pointer; }
        canvas { width: 100%; height: 100%; border-radius: 50%; transition: transform 5s cubic-bezier(0.1, 0, 0.1, 1); }
        .pointer { position: absolute; right: -10px; top: 50%; transform: translateY(-50%); border-top: 15px solid transparent; border-bottom: 15px solid transparent; border-right: 25px solid #d32f2f; z-index: 100; }

        .edit-btn-circle {
            position: absolute;
            top: -20px;
            left: -20px;
            background: #3b82f6;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.5);
            z-index: 50;
        }

        .bottom-panel { width: 95%; max-width: 550px; background: var(--panel-dark); border-radius: 8px; border: 1px solid var(--border-color); direction: ltr; margin-bottom: 15px; }
        .tabs { display: flex; border-bottom: 1px solid var(--border-color); }
        .tab { flex: 1; padding: 12px; text-align: center; cursor: pointer; color: #aaa; font-weight: bold; display: flex; align-items: center; justify-content: center; }
        .tab.active { color: white; border-bottom: 2px solid white; }
        .counter { background: #444; padding: 2px 8px; border-radius: 12px; font-size: 11px; margin-left: 8px; }

        .toolbar { padding: 12px; }
        .top-row { display: flex; gap: 8px; margin-bottom: 12px; align-items: center; flex-wrap: wrap; }
        .tool-btn { padding: 7px 12px; border: none; color: white; border-radius: 4px; cursor: pointer; font-size: 14px; background: var(--btn-blue); display: flex; align-items: center; gap: 6px; font-weight: 500; }
        .icon-svg { width: 16px; height: 16px; fill: currentColor; }

        .text-container { border: 1px solid #444; border-radius: 4px; height: 160px; background: #000; padding: 10px; }
        textarea { width: 100%; height: 100%; background: transparent; color: white; border: none; outline: none; font-size: 17px; resize: none; direction: rtl; }

        .footer-tools { width: 95%; max-width: 550px; margin-bottom: 30px; }
        .add-wheel-wrap { position: relative; width: fit-content; margin-bottom: 10px; }
        .beta-tag { position: absolute; top: -12px; left: 0; background: #ffca28; color: black; font-size: 9px; font-weight: 900; padding: 1px 5px; border-radius: 3px; }
        .version-row { display: flex; justify-content: space-between; font-size: 12px; color: #888; }

        .info-card { background: var(--card-bg); border: 1px solid var(--border-color); border-radius: 12px; padding: 25px; margin-bottom: 15px; width: 95%; max-width: 550px; direction: ltr; box-sizing: border-box; }
        .section-header { display: flex; align-items: center; gap: 10px; margin-bottom: 12px; }
        .title-icon { width: 22px; height: 22px; background: conic-gradient(#4285f4, #ea4335, #fbbc05, #34a853, #4285f4); border-radius: 50%; }
        .info-card h3 { margin: 0; font-size: 18px; color: white; }
        .info-card p, .info-card li { color: #ccc; font-size: 14.5px; line-height: 1.6; }
        .link { color: var(--link-blue); text-decoration: underline; cursor: pointer; font-weight: 500; }
        .stat-val { color: var(--stat-green); font-size: 38px; font-weight: bold; line-height: 1.2; margin: 5px 0 20px 0; }

        #winnerOverlay { position: fixed; inset: 0; background: rgba(0,0,0,0.85); display: none; align-items: center; justify-content: center; z-index: 2000; }
        .winner-card { background: #1a1a1b; border-radius: 12px; width: 90%; max-width: 400px; text-align: center; overflow: hidden; }
        .winner-box { background: #3b82f6; padding: 30px; margin: 20px; border-radius: 8px; font-size: 26px; font-weight: bold; }
        
        /* تحسين استايل قصاصات الورق */
        .confetti { 
            position: fixed; 
            width: 12px; 
            height: 12px; 
            pointer-events: none; 
            z-index: 2500; 
            top: -20px;
        }
        .confetti.star {
            clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
        }
        .confetti.square {
            border-radius: 2px;
        }
        .confetti.circle {
            border-radius: 50%;
        }
    </style>
</head>
<body>

    <div class="site-header">
        <div class="logo">wheelofnames.com</div>
        <div class="menu-icon">☰</div>
    </div>

    <div class="main-stage">
        <div class="edit-btn-circle">
            <svg width="20" height="20" fill="white" viewBox="0 0 24 24"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/></svg>
        </div>

        <div class="wheel-instructions" id="wheelLabels">
            <svg class="curved-svg" viewBox="0 0 400 400">
                <path id="curvePathTop" d="M 100,200 A 100,100 0 0,1 300,200" fill="transparent" />
                <path id="curvePathBottom" d="M 100,200 A 100,100 0 0,0 300,200" fill="transparent" />
                <text class="curved-text" font-size="28">
                    <textPath href="#curvePathTop" startOffset="50%" text-anchor="middle">Click to spin</textPath>
                </text>
                <text class="curved-text" font-size="28">
                    <textPath href="#curvePathBottom" startOffset="50%" text-anchor="middle">or press ctrl+enter</textPath>
                </text>
            </svg>
        </div>

        <div class="wheel-box" onclick="spin()">
            <canvas id="wheelCanvas" width="500" height="500"></canvas>
            <div class="pointer"></div>
        </div>
    </div>

    <div class="bottom-panel">
        <div class="tabs">
            <div class="tab active" id="tab-ent" onclick="showTab('entries')">Entries <span id="entryCount" class="counter">0</span></div>
            <div class="tab" id="tab-res" onclick="showTab('results')">Results <span id="resultCount" class="counter">0</span></div>
        </div>
        <div id="entries-tab-content" class="toolbar">
            <div class="top-row">
                <button class="tool-btn" onclick="shuffleNames()">
                    <svg class="icon-svg" viewBox="0 0 24 24"><path d="M14.83,13.41L13.42,14.82L16.59,18H15C13.34,18 12,16.66 12,15V13H10V15C10,17.76 12.24,20 15,20H16.59L13.42,23.17L14.83,24.58L20.41,19L14.83,13.41M10.59,9.17L5.41,4L4,5.41L9.17,10.58L10.59,9.17M14.5,4L16.59,6.09L4,18.68L5.41,20.09L18,7.5L20.09,9.59V4H14.5Z"/></svg>
                    Shuffle
                </button>
                <button class="tool-btn" onclick="sortNames()">
                    <svg class="icon-svg" viewBox="0 0 24 24"><path d="M18,21L14,17H17V7H14L18,3L22,7H19V17H22L18,21M2,19V17H12V19H2M2,13V11H9V13H2M2,7V5H6V7H2Z"/></svg>
                    Sort
                </button>
                <button class="tool-btn">
                    <svg class="icon-svg" viewBox="0 0 24 24"><path d="M21,19V5C21,3.89 20.1,3 19,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19M8.5,13.5L11,16.5L14.5,12L19,18H5L8.5,13.5Z"/></svg>
                    Add image
                </button>
                <label style="margin-left:auto; font-size:14px;"><input type="checkbox"> Advanced</label>
            </div>
            <div class="text-container">
                <textarea id="textInput" oninput="updateWheel()">Ali&#10;Beatriz&#10;Charles&#10;Diya&#10;Eric&#10;Fatima&#10;Gabriel&#10;Hanna</textarea>
            </div>
        </div>
        <div id="results-list" style="display:none; padding:15px; direction: rtl;"></div>
    </div>

    <div class="footer-tools">
        <div class="add-wheel-wrap">
            <span class="beta-tag">Beta</span>
            <button class="tool-btn" style="background:#3b82f6; padding:8px 16px;">+ Add wheel ▾</button>
        </div>
        <div class="version-row">
            <span>Version 399</span>
            <span class="link">Changelog</span>
        </div>
    </div>

    <div class="info-card">
        <div class="section-header"><div class="title-icon"></div><h3>What is the wheel spinner for?</h3></div>
        <p>Every day we hear from people who use our website in new ways:</p>
        <ul style="padding-left: 20px;">
            <li><strong>Random name picker in the classroom:</strong> pick which student will answer the next question. <span class="link">How to use it in the classroom</span></li>
            <li>If you are a retailer, spin the wheel to pick which loyal customer will get the monthly giveaway.</li>
            <li>When you give a presentation, use the wheel spinner to pick a lucky winner among the attendees who turned in the survey.</li>
            <li><strong>Random name picker at work:</strong> in your daily standup meeting at work, randomize who speaks first.</li>
        </ul>
    </div>

    <div class="info-card">
        <div class="section-header"><div class="title-icon"></div><h3>Activity in 2026</h3></div>
        <div style="color: #888; font-size: 13px;">WHEEL SPINS</div>
        <div class="stat-val">232,544,177</div>
        <div style="color: #888; font-size: 13px;">HOURS OF SPINNING</div>
        <div class="stat-val">645,957</div>
    </div>

    <div class="info-card">
        <div class="section-header"><div class="title-icon"></div><h3>Is the wheel truly random?</h3></div>
        <p>Yes, but don't just take our word for it. We built a tool to let you prove it yourself. You can run 10,000 spins in seconds and see the results.</p>
        <button class="tool-btn" style="width: 150px; justify-content: center; margin: 10px 0 20px 0;">Run 10,000 Spins</button>
        <p>To ensure genuinely unpredictable results, this site does not use the standard Math.random() function. Instead, the wheel's physics are driven by <code>crypto.getRandomValues()</code>.</p>
    </div>

    <div class="info-card" style="margin-bottom: 80px;">
        <div class="section-header"><div class="title-icon"></div><h3>Try our Discord bot</h3></div>
        <p>Use our Discord bot to spin the wheel directly in your Discord server.</p>
        <ul style="padding-left: 20px;">
            <li>Spin with the members of your server</li>
            <li>Spin with any of your shared wheels</li>
        </ul>
        <p class="link">Add the Discord bot</p>
    </div>

    <div id="winnerOverlay">
        <div class="winner-card">
            <div style="background:#d32f2f; padding:15px; font-weight:bold;">We have a winner!</div>
            <div class="winner-box" id="winnerNameDisplay"></div>
            <div style="padding:15px; background:#252526; display:flex; justify-content:flex-end; gap:10px;">
                <button onclick="closePop()" style="background:none; border:none; color:white; cursor:pointer;">Close</button>
                <button onclick="removeWin()" style="background:#3b82f6; border:none; padding:8px 15px; border-radius:4px; color:white; font-weight:bold; cursor:pointer;">Remove</button>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('wheelCanvas'), ctx = canvas.getContext('2d');
        const textInput = document.getElementById('textInput'), resultsDiv = document.getElementById('results-list');
        
        // تعريف الملفات الصوتية المضافة
        const spinSound = new Audio('a.mp3');
        const winSound = new Audio('b.mp3');

        let names = [], rotation = 0, spinning = false, currentStep = 0;
        const scriptedWinners = ["داليا الشميري", "ابو ياسر الجبل", "سهام الحميدي"];
        const colors = ["#4285f4", "#ea4335", "#fbbc05", "#34a853", "#9c27b0"];

        function updateWheel() {
            names = textInput.value.split('\n').filter(n => n.trim() !== "");
            document.getElementById('entryCount').innerText = names.length;
            draw();
        }

        function draw() {
            const size = canvas.width, center = size / 2;
            ctx.clearRect(0, 0, size, size);
            if (names.length === 0) return;
            const arc = (2 * Math.PI) / names.length;
            names.forEach((name, i) => {
                ctx.beginPath(); ctx.fillStyle = colors[i % colors.length];
                ctx.moveTo(center, center); ctx.arc(center, center, center, i * arc, (i + 1) * arc);
                ctx.fill(); ctx.save(); ctx.translate(center, center);
                ctx.rotate(i * arc + arc / 2); ctx.textAlign = "right"; ctx.fillStyle = "white";
                ctx.font = "bold 20px Arial"; ctx.fillText(name.substring(0, 15), center - 40, 7);
                ctx.restore();
            });
            ctx.beginPath(); ctx.fillStyle = "white"; ctx.arc(center, center, 45, 0, 2 * Math.PI); ctx.fill();
        }

        function spin() {
            if (spinning || names.length === 0) return;
            spinning = true; 
            document.getElementById('wheelLabels').style.opacity = "0";

            // تشغيل صوت الدوران عند بدء الحركة
            spinSound.currentTime = 0;
            spinSound.play();

            let winner = (currentStep < scriptedWinners.length) ? scriptedWinners[currentStep++] : names[Math.floor(Math.random() * names.length)];
            const winnerIndex = names.indexOf(winner);
            const stopAngle = 360 - (winnerIndex * (360 / names.length) + (180 / names.length));
            rotation += 3600 + stopAngle - (rotation % 360);
            canvas.style.transform = `rotate(${rotation}deg)`;
            
            setTimeout(() => {
                spinning = false;

                // إيقاف صوت الدوران وتشغيل صوت الفوز (التصفيق)
                spinSound.pause();
                winSound.currentTime = 0;
                winSound.play();

                document.getElementById('winnerNameDisplay').innerText = winner;
                document.getElementById('winnerOverlay').style.display = 'flex';
                document.getElementById('wheelLabels').style.opacity = "1";
                
                const rCount = document.getElementById('resultCount');
                rCount.innerText = parseInt(rCount.innerText) + 1;
                const div = document.createElement('div');
                div.style.padding = "10px"; div.style.borderBottom = "1px solid #333";
                div.innerText = winner;
                resultsDiv.prepend(div);
                
                createConfetti();
            }, 5000);
        }

        // تحديث وظيفة القصاصات لتشمل أشكالاً متعددة وتنتشر في كامل الشاشة
        function createConfetti() {
            const shapes = ['circle', 'square', 'star'];
            for(let i=0; i<150; i++) {
                const c = document.createElement('div');
                const shape = shapes[Math.floor(Math.random() * shapes.length)];
                c.className = `confetti ${shape}`;
                c.style.background = colors[Math.floor(Math.random()*colors.length)];
                
                // تحديد موقع عشوائي على كامل عرض الشاشة
                c.style.left = Math.random() * 100 + 'vw'; 
                
                // أحجام عشوائية خفيفة
                const size = (Math.random() * 10 + 5) + 'px';
                c.style.width = size;
                c.style.height = size;

                document.body.appendChild(c);
                
                // حركة السقوط مع دوران عشوائي وتمايل
                const duration = Math.random() * 3000 + 2000;
                const xMovement = (Math.random() - 0.5) * 400; // تمايل يميناً ويساراً
                
                c.animate([
                    { transform: 'translateY(0) rotate(0deg)', opacity: 1 },
                    { transform: `translateY(100vh) translateX(${xMovement}px) rotate(${Math.random() * 720}deg)`, opacity: 0 }
                ], {
                    duration: duration,
                    easing: 'cubic-bezier(0, .9, .6, 1)'
                });

                setTimeout(() => c.remove(), duration);
            }
        }

        function showTab(t) {
            document.getElementById('entries-tab-content').style.display = t==='entries'?'block':'none';
            resultsDiv.style.display = t==='results'?'block':'none';
            document.getElementById('tab-ent').classList.toggle('active', t==='entries');
            document.getElementById('tab-res').classList.toggle('active', t==='results');
        }

        function closePop() { 
            document.getElementById('winnerOverlay').style.display='none'; 
            winSound.pause();
            winSound.currentTime = 0;
        }

        function removeWin() {
    const w = document.getElementById('winnerNameDisplay').innerText;
    
    // 1. حذف الاسم من المصفوفة
    names = names.filter(n => n !== w); 
    
    // 2. تحديث المربع النصي
    textInput.value = names.join('\n');
    
    // 3. تحديث العجلة (وهذا سيقوم بتحديث عداد Entries تلقائياً)
    updateWheel(); 
    
    // 4. إغلاق النافذة
    closePop();
}


        function shuffleNames() { names.sort(() => Math.random() - 0.5); textInput.value = names.join('\n'); updateWheel(); }
        function sortNames() { names.sort((a,b) => a.localeCompare(b, 'ar')); textInput.value = names.join('\n'); updateWheel(); }
        updateWheel();
    </script>
</body>
</html>
